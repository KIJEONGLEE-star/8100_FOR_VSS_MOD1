# DANG8100 A2B Secondary Node Windows Emulator

이 프로젝트는 DANG8100 앰프의 A2B 통신 프로토콜을 Windows 환경에서 에뮬레이션하기 위한 코드입니다.

## 기능

- A2B 네트워크의 Secondary 노드인 DANG8100의 기본 동작을 에뮬레이션
- 메일박스 통신(4바이트 패킷) 처리
- 다양한 Command Identifier(CID) 지원:
  - 네트워크 설정 및 검색
  - 오디오 제어(볼륨, 음소거)
  - 이퀄라이저(베이스, 트레블)
  - 모듈 설정 및 상태 보고
- 전압, 전류, 온도 모니터링 시뮬레이션
- 콘솔 인터페이스로 상호작용 가능

## Visual Studio에서 빌드하기

1. Visual Studio에서 새 프로젝트 생성 (빈 C 콘솔 응용 프로그램)
2. `main_windows.c` 파일을 프로젝트에 추가
3. 프로젝트 설정에서 C 표준을 C99 이상으로 설정
4. 빌드 및 실행

## 사용 가능한 명령어

프로그램을 실행한 후 다음 명령어를 사용할 수 있습니다:

- `status` - 현재 상태 표시
- `volume <0-100>` - 볼륨 레벨 설정
- `mute` - 오디오 음소거
- `unmute` - 오디오 음소거 해제
- `bass <-10 to 10>` - 베이스 레벨 설정
- `treble <-10 to 10>` - 트레블 레벨 설정
- `enable` - 모듈 활성화
- `disable` - 모듈 비활성화
- `send <hex bytes>` - 메일박스 메시지 전송 (16진수 4바이트)
- `quit` - 프로그램 종료

## 메일박스 메시지 전송 예시

메일박스 메시지는 4바이트로 구성됩니다:
1. 대상 UID (DANG8100의 경우 0x60)
2. 명령 ID (CID)
3. 파라미터 1
4. 파라미터 2

예시:
```
send 60 13 32 00  // UID:0x60, CID:0x13(볼륨), 값:50, 예약:0
send 60 15 01 00  // UID:0x60, CID:0x15(음소거), 값:1(켜기), 예약:0
send 60 70 01 00  // UID:0x60, CID:0x70(모듈 활성화), 값:1(켜기), 예약:0
```

## 하드웨어 시뮬레이션

실제 GD32E502 마이크로컨트롤러와 A2B 트랜시버(AD2433)와의 통신은 시뮬레이션됩니다. SPI 통신과 ADC 측정값(전압, 전류, 온도)은 랜덤하게 생성되는 가상의 값으로 대체됩니다.

## 프로토콜 구현

이 에뮬레이터는 AABCOP 프로토콜의 기본 동작을 구현합니다:

1. **초기화(STATE_INIT)**: 주변 장치 및 프로토콜 상태 초기화
2. **검색(STATE_DISCOVERY)**: A2B 네트워크 검색 및 초기화
3. **실행(STATE_RUNNING)**: 메일박스 메시지 처리 및 명령에 응답
4. **오류 처리(STATE_ERROR)**: 프로토콜 오류 처리

## 참고사항

이 에뮬레이터는 실제 하드웨어의 모든 기능을 구현하지는 않으며, Windows 환경에서 AABCOP 프로토콜의 기본 동작을 시뮬레이션하는 데 중점을 둡니다.